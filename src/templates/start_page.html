<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Start Page</title>
    <link rel="icon" type="image/png" href="https://git-scm.com/images/logos/downloads/Git-Icon-White.png" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'DM Sans', sans-serif;
            background: #292727db;
            color: #ffffff;
            background-image: url('{{ url_for("static", filename="images/background-3-us.jpg") }}');
            background-repeat: no-repeat;
            background-position: center center;
            background-attachment: fixed;
            background-size: cover;
            background-blend-mode: color;
        }

        h2 {
            font-weight: bold;
            margin-bottom: 25px;
            text-shadow: 6px 5px 8px #13131393;
        }

        #header-icon {
            height: 0.9em;
            width: 0.9em;
            margin-right: 0.2em;
            margin-bottom: 0.2em;
            /* box-shadow: 5px 5px 5px #13131385; */
        }

        label {
            font-weight: bold;
            font-size: 16px;
        }

        .info-icon {
            margin-left: 5px;
            
        }

        .form-control {
            background-color: #cafdf127;
            color: #f0f0f0;
            border: none;
            border-radius: 10px;
            margin-top: 8px;
        }

        .form-control:focus {
            outline: none;
            color: #f0f0f0;
            box-shadow: none;
        }

        .btn-primary {
            background-color: #1a9476;
            border: none;
            border-radius: 10px;
            color: #f0f0f0;
            padding: 10px 15px;
            font-size: 16px;
            box-shadow: 3px 2px 9px rgba(40, 40, 40, 0.368);
        }

        .btn-primary:hover {
            background-color: #157258;
        }

        .container {
            max-width: 80%;
        }

        .form-group {
            display: inline-block;
            vertical-align: top;
            position: relative;
            padding: 0 40px;
            width: 49%;
            box-sizing: border-box;
            margin:0px;
            margin-bottom: 15px;
        }

        .form-group-textarea {
            margin-bottom: 25px;
            margin-top: 10px;
        }

        .form-group:nth-child(2n)::after {
            display: none;
        }

        .form-group:nth-child(2n+1) {
            clear: left;
        }

        .horizontal-line {
            position: relative;
            max-width: 85%;
            height: 2px;
            background-color: #cdc7c719;
            margin: 10px 0;
            margin-top: 0px;
            margin-left: 6%;
            margin-right: 7%;
        }

        .form-options {
            max-height: calc(100vh - 150px);
            overflow-y: auto;
            padding-right: 10px;
        }

        .submit-button {
            position: fixed;
            bottom: 100px;
            right:5%;

        }

        @media (max-width: 767px) {
            .form-group {
                width: 100%;
                padding: 0 0 20px;
            }
        }

        input[type="radio"]{
            margin-top: 11px;
            margin-left: 25px;
            background-color: rgba(255, 255, 255, 0.345) !important;
        }

        .slider-container {
            display: flex;
            align-items: center;
            margin-right: 10px;
        }

        .slider-container input[type="range"] {
            flex-grow: 1;
            margin-right: 20px;
            box-shadow: none;
        }

        .glyphicon {
            color: #d3d3d357;
        }
        

    </style>
    <script>
        function updateSliderValue(slider, output) {
            document.getElementById(output).innerHTML = slider.value;
        }
        function toggleModelNameCompressor() {
            var compressTrue = document.getElementById("compress_true");
            var modelNameCompressor = document.getElementById("model_name_compressor").parentNode.parentNode;
            if (compressTrue.checked) {
                modelNameCompressor.style.display = "inline-block";
            } else {
                modelNameCompressor.style.display = "none";
            }
        }
        function toggleAlphaForm() {
            var vectorStorePinecone = document.getElementById("vector_store_pinecone");
            var alphaForm = document.getElementById("alpha_form");
            if (vectorStorePinecone.checked) {
                alphaForm.style.display = "inline-block";
            } else {
                alphaForm.style.display = "none";
            }
        }
        $(document).ready(function() {
            toggleModelNameCompressor();
            toggleAlphaForm();
    
            document.getElementById("vector_store_pinecone").addEventListener("change", toggleAlphaForm);
            document.getElementById("vector_store_chromadb").addEventListener("change", toggleAlphaForm);
    
            $('.info-icon').qtip({
                content: {
                    attr: 'data-tooltip'
                },
                style: {
                    classes: 'qtip-bootstrap'
                },
                position: {
                    my: 'top center',
                    at: 'bottom center'
                }
            });
        });
    </script>
    
</head>

<body>
    <div class="container">
        <h2 class="text-center" style="color: #f0f0f0;">
            <img id="header-icon" src="https://git-scm.com/images/logos/downloads/Git-Icon-White.png" alt="GitChat Icon">
            GitChat - Configuration
        </h2>   
        <form method="POST" action="{{ url_for('start') }}">
            <div class="form-options"></div>
            <div class="horizontal-line"></div>
                <div class="form-group form-group-textarea">
                    <label for="repo_url">Repo URL: <i class="info-icon glyphicon glyphicon-info-sign" data-tooltip="Enter the repository URL here [https://github.com/owner_name/repo_name]. (e.g. [https://github.com/SimonB97/GitChat])"></i></label>
                    <input type="text" class="form-control" id="repo_url" name="repo_url" placeholder="https://github.com/SimonB97/GitChat" required>
                </div>
                <div class="form-group form-group-textarea">
                    <label for="subdirectory">Subdirectory: <i class="info-icon glyphicon glyphicon-info-sign" data-tooltip="Enter the subdirectory of the repository or None (to load the whole repository) here. (e.g. [docs])"></i></label>
                    <input type="text" class="form-control" id="subdirectory" name="subdirectory" placeholder="path/to/dir">
                </div>
                <div class="horizontal-line"></div>
                <div class="form-group">
                    <label for="model_name">Model Name: <i class="info-icon glyphicon glyphicon-info-sign" data-tooltip="Select the model for Question Answering here. | GPT-4: most capable, slower | GPT-3.5-turbo: very capable, very fast"></i></label>
                    <div>
                        <input type="radio" id="gpt-3.5-turbo" name="model_name" value="gpt-3.5-turbo" checked>
                        <label for="gpt-3.5-turbo">GPT-3.5-turbo</label>
                        <input type="radio" id="gpt-4" name="model_name" value="gpt-4">
                        <label for="gpt-4">GPT-4</label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="temperature">Temperature: <i class="info-icon glyphicon glyphicon-info-sign" data-tooltip="What sampling temperature to use, between 0 and 2. Higher values like 0.8 will make the output more random, while lower values like 0.2 will make it more focused and deterministic."></i></label>
                    <div class="slider-container">
                        <input type="range" class="form-control" id="temperature" name="temperature" min="0" max="2" step="0.1" value="0.2" oninput="updateSliderValue(this, 'temperature_output')" required>
                        <span id="temperature_output">0.2</span>
                    </div>
                </div>
                <div class="horizontal-line"></div>
                <div class="form-group">
                    <label for="vector_store">Vector Store:</label>
                    <div>
                        <input type="radio" id="vector_store_pinecone" name="vector_store" value="pinecone" checked>
                        <label for="vector_store_pinecone">Pinecone</label>
                        <input type="radio" id="vector_store_chromadb" name="vector_store" value="chromadb">
                        <label for="vector_store_chromadb">Chroma</label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="update">Update:</label>
                    <div>
                        <input type="radio" id="update_true" name="update" value="true">
                        <label for="update_true">True</label>
                        <input type="radio" id="update_false" name="update" value="false" checked>
                        <label for="update_false">False</label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="top_k">Top K:</label>
                    <div class="slider-container">
                        <input type="range" class="form-control" id="top_k" name="top_k" min="1" max="30" step="1" value="6" oninput="updateSliderValue(this, 'top_k_output')" required>
                        <span id="top_k_output">6</span>
                    </div>
                </div>
                <div id="alpha_form" class="form-group">
                    <label for="alpha">Alpha: <i class="info-icon glyphicon glyphicon-info-sign" data-tooltip="The alpha parameter controls the weighting between the dense and sparse vector search scores when Hybrid Search is used, which is currently the only search option for Pinecone. (see: https://www.pinecone.io/learn/hybrid-search-intro/) 
                    [1 -> Dense Search, 0 -> Sparse Search, 0.5 -> Hybrid Search] Advice: Use higher values for documents that are likely similar to the training domain of the LLM. Use lower values for documents with domain-specific language (e.g. Code, Medical Research Papers)" ></i></label>
                    <div class="slider-container">
                        <input type="range" class="form-control" id="alpha" name="alpha" min="0.1" max="0.9" step="0.1" value="0.5" oninput="updateSliderValue(this, 'alpha_output')" required>
                        <span id="alpha_output">0.5</span>
                    </div>
                </div>
                <div class="horizontal-line"></div>
                <div class="form-group">
                    <label for="mem_window_k">Chat Memory Length: <i class="info-icon glyphicon glyphicon-info-sign" data-tooltip="Enter the memory window size here. This determines how many of the latest messages should be kept in the AIs memory."></i></label>
                    <div class="slider-container">
                        <input type="range" class="form-control" id="mem_window_k" name="mem_window_k" min="0" max="40" step="1" value="6" oninput="updateSliderValue(this, 'mem_window_k_output')" required>
                        <span id="mem_window_k_output">6</span>
                    </div>
                </div>                
                <div class="form-group">
                    <label for="compress">Compress:</label>
                    <div>
                        <input type="radio" id="compress_true" name="compress" value="true" onchange="toggleModelNameCompressor()">
                        <label for="compress_true">True</label>
                        <input type="radio" id="compress_false" name="compress" value="false" checked onchange="toggleModelNameCompressor()">
                        <label for="compress_false">False</label>

                    </div>
                </div>
                <div class="form-group form-group-textarea">
                    <label for="model_name_compressor">Model Name Compressor:</label>
                    <div>
                        <select id="model_name_compressor" name="model_name_compressor" class="form-control">
                            <option value="text-davinci-003">text-davinci-003</option>
                            <option value="text-davinci-002">text-davinci-002</option>
                            <option value="gpt-3.5-turbo">gpt-3.5-turbo</option>
                            <option value="gpt-3.5-turbo-0301">gpt-3.5-turbo-0301</option>
                            <option value="text-curie-001">text-curie-001</option>
                            <option value="gpt-4">gpt-4</option>
                            <option value="gpt-4-0314">gpt-4-0314</option>
                            <option value="gpt-4-32k">gpt-4-32k</option>
                            <option value="gpt-4-32k-0314">gpt-4-32k-0314</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="provide_sources">Provide Sources:</label>
                    <div>
                        <input type="radio" id="provide_sources_true" name="provide_sources" value="true">
                        <label for="provide_sources_true">True</label>
                        <input type="radio" id="provide_sources_false" name="provide_sources" value="false" checked>
                        <label for="provide_sources_false">False</label>
                    </div>
                </div>
                <div class="horizontal-line"></div>
            </div>
            <button type="submit" class="btn btn-primary submit-button">Start Chat</button>
        </form>
    </div>
</body>

</html>